#include <bits/stdc++.h>

char G[50][50];
int n,m;
std::pair<int, int> NE[24][4] = {{{0, -1}, {0, 1}, {1, 0}, {-1, 0}},
								 {{0, -1}, {0, 1}, {-1, 0}, {1, 0}},
								 {{0, -1}, {1, 0}, {0, 1}, {-1, 0}},
								 {{0, -1}, {1, 0}, {-1, 0}, {0, 1}},
								 {{0, -1}, {-1, 0}, {0, 1}, {1, 0}},
								 {{0, -1}, {-1, 0}, {1, 0}, {0, 1}},
								 {{0, 1}, {-1, 0}, {1, 0}, {0, -1}},
								 {{0, 1}, {-1, 0}, {0, -1}, {1, 0}},
								 {{0, 1}, {1, 0}, {0, -1}, {-1, 0}},
								 {{0, 1}, {1, 0}, {-1, 0}, {0, -1}},
								 {{0, 1}, {0, -1}, {-1, 0}, {1, 0}},
								 {{0, 1}, {0, -1}, {1, 0}, {-1, 0}},
								 {{-1, 0}, {0, -1}, {1, 0}, {0, 1}},
								 {{-1, 0}, {0, -1}, {0, 1}, {1, 0}},
								 {{-1, 0}, {0, 1}, {0, -1}, {1, 0}},
								 {{-1, 0}, {0, 1}, {1, 0}, {0, -1}},
								 {{-1, 0}, {1, 0}, {0, -1}, {0, 1}},
								 {{-1, 0}, {1, 0}, {0, 1}, {0, -1}},
								 {{1, 0}, {-1, 0}, {0, 1}, {0, -1}},
								 {{1, 0}, {-1, 0}, {0, -1}, {0, 1}},
								 {{1, 0}, {0, -1}, {-1, 0}, {0, 1}},
								 {{1, 0}, {0, -1}, {0, 1}, {-1, 0}},
								 {{1, 0}, {0, 1}, {-1, 0}, {0, -1}},
								 {{1, 0}, {0, 1}, {0, -1}, {-1, 0}}}; 


int main(void)
{
	memset(G,'.',sizeof(G));
	std::cin>>n>>m;
	int x,y;
	for(int i=0;i<n;i++)
	{
		for(int j=0;j<m;j++)
		{	
			std::cin>>G[i][j];
			if(G[i][j] == 'S')
			{
				x = i;
				y = j;
			}
		}		
	}	
	int c=0;
	std::string s;
	std::cin>>s;
	for(int i=0;i<24;i++)
	{
		int sx = x,sy = y;
		for(int j=0,k=(int)s.size();j<k;j++)
		{
			int u = NE[i][s[j]-'0'].first;
			int v = NE[i][s[j]-'0'].second;
			int cx = sx + u;
			int cy = sy + v;
			if(cx >= n || cx < 0 || cy >= m || cy < 0 || G[cx][cy] == '#')
			break;	
			else if(G[cx][cy] == 'E')
			{
				c++;
				break;
			}	
			else
			{
				sx = cx;
				sy = cy;
			}	
		}	
	}
	std::cout<<c<<"\n";
	return 0;	
} 